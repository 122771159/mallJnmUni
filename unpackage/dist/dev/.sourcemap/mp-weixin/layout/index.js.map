{"version":3,"file":"index.js","sources":["layout/index.vue","/Users/lijinmu/Documents/HBuilderProjects/mallJnmUni/layout/index.vue?type=component"],"sourcesContent":["<template>\r\n  <view>\r\n    <uv-navbar :title=\"title\" :placeholder=\"true\">\r\n      <template v-slot:left>\r\n        <slot name=\"layout-left\">\r\n          <view class=\"uv-nav-slot\" v-if=\"!hiddenAllStrong\">\r\n            <uv-icon\r\n              name=\"arrow-left\"\r\n              size=\"24\"\r\n              @click=\"leftClick\"\r\n              v-if=\"getIsHiidenLeft()\"\r\n            ></uv-icon>\r\n            <uv-line\r\n              direction=\"column\"\r\n              :hairline=\"false\"\r\n              length=\"20\"\r\n              margin=\"0 8px\"\r\n              v-if=\"getIsHiidenCenter()\"\r\n            ></uv-line>\r\n            <uv-icon\r\n              name=\"home\"\r\n              size=\"24\"\r\n              @click=\"bacHome\"\r\n              v-if=\"getIsHiidenRight()\"\r\n            ></uv-icon>\r\n          </view>\r\n        </slot>\r\n      </template>\r\n      <template v-slot:center>\r\n        <slot name=\"layout-center\">\r\n          <text style=\"font-size: 16px; font-weight: bold\" v-if=\"title\">{{\r\n            title\r\n          }}</text>\r\n        </slot>\r\n      </template>\r\n    </uv-navbar>\r\n    <uv-toast ref=\"toastRef\"></uv-toast>\r\n    <template v-if=\"needLogin && !isLogin\">\r\n      <view :style=\"{ height: navHeight }\" class=\"need-login-view\">\r\n        <image\r\n          class=\"icon-image\"\r\n          src=\"/static/images/noLogin.png\"\r\n          mode=\"aspectFit\"\r\n          style=\"width: 500rpx; height: 500rpx\"\r\n        ></image>\r\n        <text class=\"tip-text\">您当前尚未登录</text>\r\n        <text class=\"sub-tip-text\">登录后即可体验更完整的功能服务</text>\r\n        <uv-button\r\n          type=\"primary\"\r\n          text=\"去登录\"\r\n          @click=\"goToLogin\"\r\n          class=\"login-button\"\r\n          size=\"large\"\r\n          shape=\"circle\"\r\n        ></uv-button>\r\n      </view>\r\n    </template>\r\n    <template v-else>\r\n      <slot></slot>\r\n    </template>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted } from \"vue\";\r\nconst prop = defineProps({\r\n  title: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  leftClick: {\r\n    type: Function,\r\n    default: () => {\r\n      uni.navigateBack();\r\n    },\r\n  },\r\n  hiddenLeftStrong: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  hiddenRightStrong: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  hiddenAllStrong: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  needLogin: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n});\r\nconst navigationSource = ref();\r\nconst { navHeight } = uni.$com.getHeight();\r\nconst store = uni.$com.getStore();\r\nconst isLogin = ref(store.isLogin);\r\nwatch(\r\n  () => store.isLogin,\r\n  (newVal) => {\r\n    if (!prop.needLogin) return;\r\n    isLogin.value = newVal;\r\n    // if (!isLogin.value) {\r\n    //   uni.showModal({\r\n    //     title: \"提示\",\r\n    //     content: \"请登录\",\r\n    //     showCancel: false,\r\n    //     success: ({ confirm, cancel }) => {\r\n    //       if (confirm) {\r\n    //         uni.navigateTo({ url: \"/pages/login/login\" });\r\n    //       }\r\n    //     },\r\n    //   });\r\n    // }\r\n  },\r\n  { immediate: true }\r\n);\r\n// false 代表隐藏\r\nconst getIsHiidenLeft = () => {\r\n  if (prop.hiddenAllStrong) return false;\r\n  if (prop.hiddenLeftStrong) return false;\r\n  if (navigationSource.value == \"reLaunch\") return false;\r\n  return true;\r\n};\r\nconst getIsHiidenRight = () => {\r\n  if (prop.hiddenAllStrong) return false;\r\n  if (prop.hiddenRightStrong) return false;\r\n  return true;\r\n};\r\nconst getIsHiidenCenter = () => {\r\n  if (getIsHiidenLeft() && getIsHiidenRight()) return true;\r\n  return false;\r\n};\r\nconst goToLogin = () => {\r\n  uni.navigateTo({ url: \"/pages/login/login\" });\r\n};\r\nconst toastRef = ref(null);\r\nconst handleShowToast = (params) => {\r\n  if (toastRef.value) {\r\n    toastRef.value.show({\r\n      ...params,\r\n    });\r\n  }\r\n};\r\nconst hide = () => {\r\n  if (toastRef.value) {\r\n    toastRef.value.hide();\r\n  }\r\n};\r\nconst bacHome = () => {\r\n  if (store.isLogin) {\r\n    uni.reLaunch({\r\n      url: \"/pages/index/index\",\r\n    });\r\n  } else {\r\n    uni.reLaunch({ url: \"/pages/user/user\" });\r\n  }\r\n};\r\nonLoad(() => {\r\n  const pages = getCurrentPages();\r\n  const pageStackLength = pages.length;\r\n  console.log(\"当前页面栈层级:\", pageStackLength);\r\n  // console.log('当前页面路由:', this.route); // 获取当前页面路由\r\n\r\n  if (pageStackLength === 1) {\r\n    navigationSource.value = \"reLaunch\";\r\n    console.log(\"此页面可能是通过 uni.reLaunch 打开，或者是应用的初始启动页。\");\r\n    // 在这里执行针对 reLaunch 的逻辑\r\n    // 例如：可能不显示返回按钮，或者需要加载完整数据\r\n  } else if (pageStackLength > 1) {\r\n    navigationSource.value = \"navigateTo\";\r\n    console.log(\"此页面可能是通过 uni.navigateTo 打开。\");\r\n    // 在这里执行针对 navigateTo 的逻辑\r\n    // 例如：显示返回按钮，或者从上一页获取参数进行增量更新\r\n  } else {\r\n    // 理论上 pageStackLength 至少为 1 (当前页面本身)\r\n    console.warn(\"获取页面栈层级异常!\");\r\n  }\r\n});\r\nonMounted(() => {\r\n  uni.$on(\"show-toast\", handleShowToast);\r\n  uni.$on(\"hide-toast\", hide);\r\n});\r\n\r\nonUnmounted(() => {\r\n  uni.$off(\"show-toast\", handleShowToast);\r\n  uni.$off(\"hide-toast\", hide);\r\n});\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@mixin flex($direction: row) {\r\n  /* #ifndef APP-NVUE */\r\n  display: flex;\r\n  /* #endif */\r\n  flex-direction: $direction;\r\n}\r\n\r\n.uv-nav-slot {\r\n  @include flex;\r\n  border-style: solid;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  border-width: 0.5px;\r\n  border-radius: 100px;\r\n  border-color: #dadbde;\r\n  padding: 3px 7px;\r\n  opacity: 0.8;\r\n}\r\n.need-login-view {\r\n  @include flex;\r\n  align-items: center;\r\n  flex-direction: column;\r\n}\r\n.content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  text-align: center;\r\n  padding: 30px;\r\n  background-color: #ffffff; // 卡片式背景\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); // 轻微阴影效果\r\n}\r\n\r\n.icon-image {\r\n  width: 80px;\r\n  height: 80px;\r\n  margin-bottom: 20px;\r\n  // 确保您的 /static/images/unlogin_icon.png 路径下有对应的图标文件\r\n  // 如果没有，可以暂时移除此行，或替换为 uv-icon 等其他图标方案\r\n}\r\n\r\n.tip-text {\r\n  font-size: 18px;\r\n  color: #333;\r\n  font-weight: bold;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.sub-tip-text {\r\n  font-size: 14px;\r\n  color: #888;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.login-button {\r\n  width: 100%; // 按钮宽度充满内容区域\r\n  max-width: 280px; // 给按钮一个最大宽度，避免在大屏上过宽\r\n  // uv-button 已经有很多内置样式，这里可以按需调整\r\n  // 例如，如果想自定义按钮颜色，可以在 uv-button 上设置 customStyle\r\n}\r\n</style>\r\n","import Component from '/Users/lijinmu/Documents/HBuilderProjects/mallJnmUni/layout/index.vue'\nwx.createComponent(Component)"],"names":["ref","uni","watch","onLoad","onMounted","onUnmounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA,UAAM,OAAO;AA4Bb,UAAM,mBAAmBA,cAAG,IAAA;AAC5B,UAAM,EAAE,UAAS,IAAKC,cAAAA,MAAI,KAAK,UAAS;AACxC,UAAM,QAAQA,cAAG,MAAC,KAAK;AACvB,UAAM,UAAUD,cAAG,IAAC,MAAM,OAAO;AACjCE,kBAAK;AAAA,MACH,MAAM,MAAM;AAAA,MACZ,CAAC,WAAW;AACV,YAAI,CAAC,KAAK;AAAW;AACrB,gBAAQ,QAAQ;AAAA,MAajB;AAAA,MACD,EAAE,WAAW,KAAM;AAAA,IACrB;AAEA,UAAM,kBAAkB,MAAM;AAC5B,UAAI,KAAK;AAAiB,eAAO;AACjC,UAAI,KAAK;AAAkB,eAAO;AAClC,UAAI,iBAAiB,SAAS;AAAY,eAAO;AACjD,aAAO;AAAA,IACT;AACA,UAAM,mBAAmB,MAAM;AAC7B,UAAI,KAAK;AAAiB,eAAO;AACjC,UAAI,KAAK;AAAmB,eAAO;AACnC,aAAO;AAAA,IACT;AACA,UAAM,oBAAoB,MAAM;AAC9B,UAAI,gBAAiB,KAAI,iBAAkB;AAAE,eAAO;AACpD,aAAO;AAAA,IACT;AACA,UAAM,YAAY,MAAM;AACtBD,oBAAAA,MAAI,WAAW,EAAE,KAAK,qBAAsB,CAAA;AAAA,IAC9C;AACA,UAAM,WAAWD,cAAAA,IAAI,IAAI;AACzB,UAAM,kBAAkB,CAAC,WAAW;AAClC,UAAI,SAAS,OAAO;AAClB,iBAAS,MAAM,KAAK;AAAA,UAClB,GAAG;AAAA,QACT,CAAK;AAAA,MACF;AAAA,IACH;AACA,UAAM,OAAO,MAAM;AACjB,UAAI,SAAS,OAAO;AAClB,iBAAS,MAAM;MAChB;AAAA,IACH;AACA,UAAM,UAAU,MAAM;AACpB,UAAI,MAAM,SAAS;AACjBC,sBAAAA,MAAI,SAAS;AAAA,UACX,KAAK;AAAA,QACX,CAAK;AAAA,MACL,OAAS;AACLA,sBAAAA,MAAI,SAAS,EAAE,KAAK,mBAAoB,CAAA;AAAA,MACzC;AAAA,IACH;AACAE,kBAAAA,OAAO,MAAM;AACX,YAAM,QAAQ;AACd,YAAM,kBAAkB,MAAM;AAC9BF,oBAAA,MAAA,MAAA,OAAA,2BAAY,YAAY,eAAe;AAGvC,UAAI,oBAAoB,GAAG;AACzB,yBAAiB,QAAQ;AACzBA,sBAAAA,MAAA,MAAA,OAAA,2BAAY,uCAAuC;AAAA,MAGvD,WAAa,kBAAkB,GAAG;AAC9B,yBAAiB,QAAQ;AACzBA,sBAAAA,MAAA,MAAA,OAAA,2BAAY,6BAA6B;AAAA,MAG7C,OAAS;AAELA,sBAAAA,+CAAa,YAAY;AAAA,MAC1B;AAAA,IACH,CAAC;AACDG,kBAAAA,UAAU,MAAM;AACdH,oBAAAA,MAAI,IAAI,cAAc,eAAe;AACrCA,oBAAAA,MAAI,IAAI,cAAc,IAAI;AAAA,IAC5B,CAAC;AAEDI,kBAAAA,YAAY,MAAM;AAChBJ,oBAAAA,MAAI,KAAK,cAAc,eAAe;AACtCA,oBAAAA,MAAI,KAAK,cAAc,IAAI;AAAA,IAC7B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1LD,GAAG,gBAAgB,SAAS;"}